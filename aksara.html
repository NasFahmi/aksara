<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Konverter Latin-Aksara Jawa (Dua Arah, Swap, Debounce)</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", sans-serif;
      }
      body {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        min-height: 100vh;
        padding: 20px;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
      }
      header {
        background: linear-gradient(135deg, #2c3e50 0%, #4a6491 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }
      h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
      }
      .content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        padding: 30px;
      }
      @media (max-width: 768px) {
        .content {
          grid-template-columns: 1fr;
        }
      }
      textarea {
        width: 100%;
        min-height: 200px;
        padding: 20px;
        font-size: 1.1rem;
        border: 2px solid #e9ecef;
        border-radius: 10px;
        resize: vertical;
      }
      .output-area {
        font-family: "Noto Sans JP", sans-serif;
        font-size: 1.8rem;
        background: #f8f9fa;
      }
      .controls {
        display: flex;
        gap: 15px;
        margin-top: 20px;
        flex-wrap: wrap;
        align-items: center; /* Untuk menyelaraskan tombol dan ikon tukar */
      }
      button {
        padding: 12px 25px;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
      }
      .btn-primary {
        background: linear-gradient(135deg, #4a6491 0%, #2c3e50 100%);
        color: white;
      }
      .btn-secondary {
        background: #e9ecef;
        color: #495057;
      }
      .btn-success {
        background: #20c997;
        color: white;
      }
      .btn-warning {
        background: #fab005;
        color: #212529;
      }
      .btn-swap {
        background: #868e96;
        width: 2rem;
        height: 2rem;
        color: white;
        padding: 8px 15px; /* Sedikit padding untuk ikon */
        font-size: 1.2rem; /* Ukuran ikon */
        border: none;
        border-radius: 50%; /* Membuat tombol bulat */
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .examples {
        background: #fff9db;
        padding: 20px;
        margin: 20px 30px;
        border-radius: 10px;
        border-left: 5px solid #f59f00;
      }
      .example-item {
        margin: 10px 0;
        padding: 10px;
        background: white;
        border-radius: 5px;
      }
      .correct {
        color: #2b8a3e;
        font-weight: bold;
      }
      .incorrect {
        color: #c92a2a;
        text-decoration: line-through;
      }
      .debug-info {
        background: #e7f5ff;
        padding: 15px;
        margin: 10px 0;
        border-radius: 5px;
        font-family: monospace;
      }
    </style>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Í¶èÍ¶∫Í¶¥Í¶§ÍßÄÍ¶ÆÍ¶ºÍ¶ÇÍ¶±Í¶∂Í¶≠Í¶†Í¶∂Í¶§ÍßÄÍ¶≤Í¶èÍßÄÍ¶±Í¶´Í¶óÍ¶Æ</h1>
        <p>Dengan Algoritma Tata Bahasa yang Benar</p>
      </header>
      <div style="display: flex; justify-content: center; margin: 20px 0">
        <button class="btn-swap" id="swapBtn" title="Tukar">üîÑ</button>
      </div>

      <div class="content">
        <div>
          <h2>Teks Latin</h2>
          <textarea id="inputText" placeholder="Ketik teks Latin di sini...">
Banyuwangi, Wahyu Hariyanto, Sugeng rawuh</textarea
          >
          <div class="controls">
            <button class="btn-primary" id="convertToJavaneseBtn">
              Konversi (Latin ‚Üí Aksara)
            </button>
            <button class="btn-secondary" id="resetAllBtn">Reset Semua</button>
          </div>
        </div>

        <div>
          <h2>Aksara Jawa</h2>
          <div style="display: flex; align-items: center">
            <!-- Container untuk textarea dan tombol tukar -->
            <textarea
              id="outputText"
              class="output-area"
              placeholder="Hasil konversi Aksara Jawa akan muncul di sini..."
            ></textarea>

            <!-- Tombol Tukar -->
          </div>
          <div class="controls">
            <button class="btn-success" id="copyBtn">Salin Hasil</button>
            <button class="btn-warning" id="convertToLatinBtn">
              Konversi (Aksara ‚Üí Latin)
            </button>
          </div>
        </div>
      </div>

      <div class="examples">
        <h3>Contoh Konversi:</h3>
        <div class="example-item">
          <span class="correct">Latin: Banyuwangi ‚Üí Aksara: Í¶ßÍ¶öÍ¶∏Í¶ÆÍ¶îÍ¶∂</span>
        </div>
        <div class="example-item">
          <span class="correct">Aksara: Í¶≤Í¶´Í¶∂Í¶™Í¶§ÍßÄÍ¶†Í¶∫Í¶¥ ‚Üí Latin: hariyanto</span>
        </div>
      </div>
    </div>

    <script>
      // ======================== ALGORITMA KONVERSI LENGKAP ========================

      //   Aksara Dasar
      const AKSARA = {
        h: "Í¶≤",
        n: "Í¶§",
        c: "Í¶ï",
        r: "Í¶´",
        k: "Í¶è",
        d: "Í¶¢",
        t: "Í¶†",
        s: "Í¶±",
        w: "Í¶Æ",
        l: "Í¶≠",
        p: "Í¶•",
        j: "Í¶ó",
        y: "Í¶™",
        m: "Í¶©",
        g: "Í¶í",
        b: "Í¶ß",
        ng: "Í¶î",
        ny: "Í¶ö",
        th: "Í¶õ",
        dh: "Í¶ù",
      };

      // Pasangan
      const PASANGAN = {
        h: "ÍßÄÍ¶≤",
        n: "ÍßÄÍ¶§",
        c: "ÍßÄÍ¶ï",
        r: "ÍßÄÍ¶´",
        k: "ÍßÄÍ¶è",
        d: "ÍßÄÍ¶¢",
        t: "ÍßÄÍ¶†",
        s: "ÍßÄÍ¶±",
        w: "ÍßÄÍ¶Æ",
        l: "ÍßÄÍ¶≠",
        p: "ÍßÄÍ¶•",
        j: "ÍßÄÍ¶ó",
        y: "ÍßÄÍ¶™",
        m: "ÍßÄÍ¶©",
        g: "ÍßÄÍ¶í",
        b: "ÍßÄÍ¶ß",
        ng: "ÍßÄÍ¶î",
        ny: "ÍßÄÍ¶ö",
        th: "ÍßÄÍ¶õ",
        dh: "ÍßÄÍ¶ù",
      };

      //Sandhangan Vokal
      const VOKAL = {
        a: "",
        i: "Í¶∂",
        u: "Í¶∏",
        e: "Í¶º",
        √©: "Í¶∫",
        o: "Í¶∫Í¶¥",
      };

      // Vokal Mandiri
      const VOKAL_MANDIRI = {
        a: "Í¶Ñ",
        i: "Í¶Ü",
        u: "Í¶à",
        e: "Í¶å",
        o: "Í¶é",
      };

      const AKHIRAN = {
        ng: "Í¶Å",
        r: "Í¶Ç",
        h: "Í¶É",
      };

      const CLUSTER = {
        r: "Í¶ø",
        y: "Í¶æ",
        l: "Í¶≠Í¶æ", // Ini penting: 'l' cluster menjadi dua karakter aksara: ' lavender_char ' + 'yellow_char '
        w: "Í¶Æ",
      };

      const MURDA = {
        n: "Í¶ü",
        k: "Í¶ë",
        t: "Í¶°",
        s: "Í¶Ø",
        p: "Í¶¶",
        b: "Í¶®",
        g: "Í¶ì",
        j: "Í¶ô",
      };

      function tokenize(text) {
        const raw = text.match(/ng|ny|dh|th|[A-Za-z]|[^\w\s]+|\s+/g) || [];

        return raw.map((t) => ({
          raw: t,
          lower: t.toLowerCase(),
        }));
      }

      function isVowel(t) {
        return t && VOKAL.hasOwnProperty(t.lower);
      }

      function isConsonant(t) {
        return t && AKSARA.hasOwnProperty(t.lower);
      }

      function applyPangkon(syllables) {
        for (let i = 0; i < syllables.length - 1; i++) {
          const curr = syllables[i];
          const next = syllables[i + 1];

          if (!curr.onset || !next.onset) continue;

          if (curr.vowel && next.vowel) continue;
          if (next.cluster) continue;
          if (curr.coda) continue;

          curr.dead = true;
        }
      }

      function parseSyllables(tokens) {
        const result = [];
        let i = 0;

        while (i < tokens.length) {
          const t = tokens[i].lower;
          const raw = tokens[i].raw;

          if (!/[a-z]/.test(t)) {
            result.push({ type: "symbol", value: t });
            i++;
            continue;
          }

          if (isVowel(t)) {
            result.push({ onset: null, vowel: t, coda: null });
            i++;
            continue;
          }

          if (isConsonant(tokens[i])) {
            let onset = tokens[i].lower;
            let isCapital = tokens[i].raw !== tokens[i].raw.toLowerCase();
            let vowel = "a";
            let coda = null;
            let cluster = null;

            if (["r", "y", "l", "w"].includes(tokens[i + 1]?.lower)) {
              cluster = tokens[i + 1].lower;
              i++;
            }

            if (isVowel(tokens[i + 1])) {
              vowel = tokens[i + 1].lower;
              i++;
            }

            if (AKHIRAN[tokens[i + 1]?.lower]) {
              coda = tokens[i + 1].lower;
              i++;
            }

            result.push({
              onset,
              vowel,
              coda,
              cluster,
              dead: false,
              isCapital,
            });

            i++;
            continue;
          }

          i++;
        }

        return result;
      }

      function render(syllables) {
        let out = "";

        syllables.forEach((s, idx) => {
          if (s.type === "symbol") {
            out += s.value;
            return;
          }

          if (!s.onset) {
            out += VOKAL_MANDIRI[s.vowel];
            return;
          }

          if (s.isCapital && MURDA[s.onset]) {
            out += MURDA[s.onset];
          } else {
            out += AKSARA[s.onset];
          }

          if (s.cluster) {
            out += CLUSTER[s.cluster];
          }

          out += VOKAL[s.vowel] || "";

          if (s.coda) {
            out += AKHIRAN[s.coda] || PASANGAN[s.coda];
          }

          if (s.dead && !s.coda) {
            out += "ÍßÄ";
          }
        });

        return out;
      }

      function latinToJawa(text) {
        const tokens = tokenize(text);
        const syllables = parseSyllables(tokens);
        applyPangkon(syllables);
        return render(syllables);
      }

      // --- Fungsi Konversi Aksara Jawa ke Latin ---
      function jawaToLatin(text) {
        const MAP_SWARA = { Í¶Ñ: "a", Í¶Ü: "i", Í¶à: "u", Í¶å: "e", Í¶é: "o" };
        const MAP_AKSARA = {
          Í¶≤: "h",
          Í¶§: "n",
          Í¶ï: "c",
          Í¶´: "r",
          Í¶è: "k",
          Í¶¢: "d",
          Í¶†: "t",
          Í¶±: "s",
          Í¶Æ: "w",
          Í¶≠: "l",
          Í¶•: "p",
          Í¶ó: "j",
          Í¶™: "y",
          Í¶©: "m",
          Í¶í: "g",
          Í¶ß: "b",
          Í¶î: "ng",
          Í¶ö: "ny",
          Í¶õ: "th",
          Í¶ù: "dh",
          Í¶ü: "n",
          Í¶ë: "k",
          Í¶°: "t",
          Í¶Ø: "s",
          Í¶¶: "p",
          Í¶®: "b",
          Í¶ì: "g",
          Í¶ô: "j",
        };
        const MAP_VOKAL = { "Í¶∂": "i", "Í¶∏": "u", "Í¶º": "e", "Í¶∫": "√©", "Í¶∫Í¶¥": "o" };
        const MAP_CACARA = { "Í¶Å": "ng", "Í¶Ç": "r", "Í¶É": "h" };
        const MAP_PASANGAN = {
          "ÍßÄÍ¶≤": "h",
          "ÍßÄÍ¶§": "n",
          "ÍßÄÍ¶ï": "c",
          "ÍßÄÍ¶´": "r",
          "ÍßÄÍ¶è": "k",
          "ÍßÄÍ¶¢": "d",
          "ÍßÄÍ¶†": "t",
          "ÍßÄÍ¶±": "s",
          "ÍßÄÍ¶Æ": "w",
          "ÍßÄÍ¶≠": "l",
          "ÍßÄÍ¶•": "p",
          "ÍßÄÍ¶ó": "j",
          "ÍßÄÍ¶™": "y",
          "ÍßÄÍ¶©": "m",
          "ÍßÄÍ¶í": "g",
          "ÍßÄÍ¶ß": "b",
          "ÍßÄÍ¶î": "ng",
          "ÍßÄÍ¶ö": "ny",
          "ÍßÄÍ¶õ": "th",
          "ÍßÄÍ¶ù": "dh",
        };
        const MAP_CLUSTER_TUNGGAL = { "Í¶ø": "r", "Í¶æ": "y", Í¶Æ: "w" };

        const chars = Array.from(text);
        let result = "";
        let i = 0;

        while (i < chars.length) {
          const current = chars[i];

          if (current in MAP_SWARA) {
            result += MAP_SWARA[current];
            i++;
            continue;
          }

          if (i + 1 < chars.length) {
            const bigram = current + chars[i + 1];
            if (MAP_PASANGAN[bigram]) {
              result += MAP_PASANGAN[bigram];
              i += 2;
              continue;
            }
          }

          if (MAP_CACARA[current]) {
            result += MAP_CACARA[current];
            i++;
            continue;
          }

          if (MAP_VOKAL[current]) {
            if (
              current === "Í¶∫" &&
              i + 1 < chars.length &&
              chars[i + 1] === "Í¶¥"
            ) {
              result += "o"; // Gabungkan 'Í¶∫' + 'Í¶¥' menjadi 'o'
              i += 2;
            } else {
              result += MAP_VOKAL[current];
              i++;
            }
            continue;
          }

          if (MAP_AKSARA[current]) {
            let unit = MAP_AKSARA[current];
            i++;

            // Cek cluster 'l' (' lavender_char ' + 'yellow_char ')
            if (
              current &&
              i < chars.length &&
              chars[i] === " lavender_char " &&
              i + 1 < chars.length &&
              chars[i + 1] === "yellow_char "
            ) {
              unit += "l";
              i += 2;
            }
            // Cek cluster tunggal (r, y, w)
            else if (i < chars.length && MAP_CLUSTER_TUNGGAL[chars[i]]) {
              unit += MAP_CLUSTER_TUNGGAL[chars[i]];
              i++;
            }

            let addedVowelOrCodaOrPangkon = false;
            if (i < chars.length) {
              if (MAP_VOKAL[chars[i]]) {
                if (
                  chars[i] === "Í¶∫" &&
                  i + 1 < chars.length &&
                  chars[i + 1] === "Í¶¥"
                ) {
                  unit += "o";
                  i += 2;
                } else {
                  unit += MAP_VOKAL[chars[i]];
                  i++;
                }
                addedVowelOrCodaOrPangkon = true;
              } else if (MAP_CACARA[chars[i]]) {
                unit += MAP_CACARA[chars[i]];
                i++;
                addedVowelOrCodaOrPangkon = true;
              } else if (chars[i] === "ÍßÄ") {
                // Pangkon ditemukan, konsonan mati. Tidak tambahkan 'a'.
                i++; // Lewati pangkon
                addedVowelOrCodaOrPangkon = true; // Tandai agar 'a' tidak ditambahkan
              }
            }

            if (!addedVowelOrCodaOrPangkon) {
              unit += "a"; // Tambahkan vokal default
            }

            result += unit;
            continue;
          }

          result += current;
          i++;
        }

        return result;
      }

      // --- Debounce Function ---
      let debounceTimer = null;
      function debounce(func, delay) {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(func, delay);
      }

      // --- Event Listeners ---
      document.addEventListener("DOMContentLoaded", () => {
        const inputTextElement = document.getElementById("inputText");
        const outputTextElement = document.getElementById("outputText");
        const convertToJavaneseBtn = document.getElementById(
          "convertToJavaneseBtn"
        );
        const convertToLatinBtn = document.getElementById("convertToLatinBtn");
        const copyBtn = document.getElementById("copyBtn");
        const resetAllBtn = document.getElementById("resetAllBtn");
        const swapBtn = document.getElementById("swapBtn"); // Tombol Tukar

        // Fungsi konversi otomatis berdasarkan bidang aktif
        function autoConvert() {
          const activeElement = document.activeElement;
          if (activeElement === inputTextElement) {
            // Jika bidang Latin aktif, konversi ke Aksara
            const input = inputTextElement.value;
            const converted = latinToJawa(input);
            outputTextElement.value = converted;
          } else if (activeElement === outputTextElement) {
            // Jika bidang Aksara aktif, konversi ke Latin
            const input = outputTextElement.value;
            const converted = jawaToLatin(input);
            inputTextElement.value = converted;
          }
        }

        // Event listener untuk konversi otomatis dengan debounce
        inputTextElement.addEventListener("input", () => {
          debounce(autoConvert, 500);
        });

        outputTextElement.addEventListener("input", () => {
          debounce(autoConvert, 500);
        });

        // Tombol konversi manual tetap berfungsi
        convertToJavaneseBtn.addEventListener("click", () => {
          const input = inputTextElement.value;
          const converted = latinToJawa(input);
          outputTextElement.value = converted;
        });

        convertToLatinBtn.addEventListener("click", () => {
          const input = outputTextElement.value;
          const converted = jawaToLatin(input);
          inputTextElement.value = converted;
        });

        // Tombol Salin
        copyBtn.addEventListener("click", () => {
          outputTextElement.select();
          document.execCommand("copy");
          alert("Hasil Aksara Jawa disalin!");
        });

        // Tombol Reset
        resetAllBtn.addEventListener("click", () => {
          inputTextElement.value = "";
          outputTextElement.value = "";
        });

        // Tombol Tukar
        swapBtn.addEventListener("click", () => {
          const temp = inputTextElement.value;
          inputTextElement.value = outputTextElement.value;
          outputTextElement.value = temp;

          // Secara opsional, fokus kembali ke bidang yang sebelumnya aktif
          // Kita bisa melacaknya, tapi untuk saat ini, kita fokus ke inputText
          inputTextElement.focus();
        });
      });

      // --- Testing ---
      console.log("=== Testing Latin ke Aksara ===");
      console.log(latinToJawa("banyuwangi")); // Í¶ßÍ¶öÍ¶∏Í¶ÆÍ¶îÍ¶∂
      console.log(latinToJawa("wahyu")); // Í¶ÆÍ¶ÉÍ¶™Í¶∏
      console.log(latinToJawa("hariyanto")); // Í¶≤Í¶´Í¶∂Í¶™Í¶§ÍßÄÍ¶†Í¶∫Í¶¥
      console.log(latinToJawa("sugeng rawuh")); // Í¶±Í¶∏Í¶íÍ¶ºÍ¶Å Í¶´Í¶ÆÍ¶∏Í¶É
      console.log(latinToJawa("bant")); // Í¶ßÍ¶§ÍßÄÍ¶†
      console.log(latinToJawa("kartu")); // Í¶èÍ¶ÇÍ¶†Í¶∏
      console.log(latinToJawa("bangsa")); // Í¶ßÍ¶ÅÍ¶±
      console.log(latinToJawa("kra")); // Í¶èÍ¶ø
      console.log(latinToJawa("kri")); // Í¶èÍ¶øÍ¶∂
      console.log(latinToJawa("kya")); // Í¶èÍ¶æ
      console.log(latinToJawa("gla")); // Í¶íÍ¶≠Í¶æ
      console.log(latinToJawa("dwa")); // Í¶¢Í¶Æ
      console.log(latinToJawa("Banyuwangi")); // Í¶®Í¶öÍ¶∏Í¶ÆÍ¶îÍ¶∂
      console.log(latinToJawa("Surakarta")); // Í¶ØÍ¶∏Í¶´Í¶èÍ¶ÇÍ¶†
      console.log(latinToJawa("Negara")); // Í¶üÍ¶ºÍ¶íÍ¶´
      console.log(latinToJawa("sugeng Rawuh")); // Í¶±Í¶∏Í¶íÍ¶ºÍ¶Å Í¶´Rawuh

      console.log("\n=== Testing Aksara ke Latin ===");
      console.log(jawaToLatin("Í¶ßÍ¶öÍ¶∏Í¶ÆÍ¶îÍ¶∂")); // banyuwangi
      console.log(jawaToLatin("Í¶ÆÍ¶ÉÍ¶™Í¶∏")); // wahyu
      console.log(jawaToLatin("Í¶≤Í¶´Í¶∂Í¶™Í¶§ÍßÄÍ¶†Í¶∫Í¶¥")); // hariyanto
      console.log(jawaToLatin("Í¶±Í¶∏Í¶íÍ¶ºÍ¶Å Í¶´Í¶ÆÍ¶∏Í¶É")); // sugeng rawuh
      console.log(jawaToLatin("Í¶èÍ¶øÍ¶∂")); // kri
      console.log(jawaToLatin("Í¶ßÍ¶§ÍßÄÍ¶†")); // bant
      console.log(jawaToLatin("Í¶±Í¶™ Í¶§Í¶ªÍ¶èÍßÄ Í¶èÍ¶∏Í¶¢ Í¶¢Í¶∂ Í¶óÍ¶Æ")); // saya naik kuda di java (sederhana)
      console.log(jawaToLatin("Í¶íÍ¶≠Í¶æ")); // gla
      console.log(jawaToLatin("Í¶¢Í¶Æ")); // dwa
      console.log(jawaToLatin("Í¶¢Í¶øÍ¶Æ")); // draw
      console.log(jawaToLatin("Í¶èÍ¶ø")); // kra
      console.log(jawaToLatin("Í¶èÍ¶æ")); // kya
      console.log(jawaToLatin("Í¶≤Í¶èÍßÄÍ¶±Í¶´")); // haksara
      console.log(jawaToLatin("Í¶ÑÍ¶§ÍßÄÍ¶†Í¶´")); // antara
    </script>
  </body>
</html>
